user www-data;
worker_processes auto;
pid /run/nginx.pid;

# Dynamic modules (assume installed)
load_module modules/ngx_http_zstd_filter_module.so;
load_module modules/ngx_http_zstd_static_module.so;
load_module modules/ngx_http_brotli_filter_module.so;
load_module modules/ngx_http_brotli_static_module.so;

events { worker_connections 1024; }

http {
  include /etc/nginx/mime.types;
  default_type application/octet-stream;
  server_tokens off;

  server {
    listen 80;
    listen [::]:80;
    server_name {{ domain }} {{ domain | regex_replace('^www\\.', '') }};
    root /var/www/letsencrypt;

    location / {
      try_files $uri =404;
    }
  }
}
